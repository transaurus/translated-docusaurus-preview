---
slug: /sidebar/autogenerated
---

# 自动生成

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Docusaurus 能够根据**文件系统结构自动创建侧边栏**：每个文件夹生成一个侧边栏分类，每个文件生成一个文档链接。

```ts
type SidebarItemAutogenerated = {
  type: 'autogenerated';
  dirName: string; // Source folder to generate the sidebar slice from (relative to docs)
};
```

Docusaurus 可以从您的文档文件夹生成完整侧边栏：

```js title="sidebars.js"
export default {
  myAutogeneratedSidebar: [
    // highlight-start
    {
      type: 'autogenerated',
      dirName: '.', // '.' means the current docs folder
    },
    // highlight-end
  ],
};
```

`autogenerated` 条目会被 Docusaurus 转换为**侧边栏片段**（在[分类速记法](items.mdx#category-shorthand)中也有讨论）：即一组类型为 `doc` 或 `category` 的条目集合，因此您可以在同一侧边栏层级中**混合多个目录的 `autogenerated` 条目**，并与常规侧边栏条目交错排列。

<details>
<summary>A real-world example</summary>

Consider this file structure:

```bash
docs
├── api
│   ├── product1-api
│   │   └── api.md
│   └── product2-api
│       ├── basic-api.md
│       └── pro-api.md
├── intro.md
└── tutorials
    ├── advanced
    │   ├── advanced1.md
    │   ├── advanced2.md
    │   └── read-more
    │       ├── resource1.md
    │       └── resource2.md
    ├── easy
    │   ├── easy1.md
    │   └── easy2.md
    ├── tutorial-end.md
    ├── tutorial-intro.md
    └── tutorial-medium.md
```

And assume every doc's ID is just its file name. If you define an autogenerated sidebar like this:

```js title="sidebars.js"
export default {
  mySidebar: [
    'intro',
    {
      type: 'category',
      label: 'Tutorials',
      items: [
        'tutorial-intro',
        // highlight-start
        {
          type: 'autogenerated',
          dirName: 'tutorials/easy', // Generate sidebar slice from docs/tutorials/easy
        },
        // highlight-end
        'tutorial-medium',
        // highlight-start
        {
          type: 'autogenerated',
          dirName: 'tutorials/advanced', // Generate sidebar slice from docs/tutorials/advanced
        },
        // highlight-end
        'tutorial-end',
      ],
    },
    // highlight-start
    {
      type: 'autogenerated',
      dirName: 'api', // Generate sidebar slice from docs/api
    },
    // highlight-end
    {
      type: 'category',
      label: 'Community',
      items: ['team', 'chat'],
    },
  ],
};
```

It would be resolved as:

```js title="sidebars.js"
export default {
  mySidebar: [
    'intro',
    {
      type: 'category',
      label: 'Tutorials',
      items: [
        'tutorial-intro',
        // highlight-start
        // Two files in docs/tutorials/easy
        'easy1',
        'easy2',
        // highlight-end
        'tutorial-medium',
        // highlight-start
        // Two files and a folder in docs/tutorials/advanced
        'advanced1',
        'advanced2',
        {
          type: 'category',
          label: 'read-more',
          items: ['resource1', 'resource2'],
        },
        // highlight-end
        'tutorial-end',
      ],
    },
    // highlight-start
    // Two folders in docs/api
    {
      type: 'category',
      label: 'product1-api',
      items: ['api'],
    },
    {
      type: 'category',
      label: 'product2-api',
      items: ['basic-api', 'pro-api'],
    },
    // highlight-end
    {
      type: 'category',
      label: 'Community',
      items: ['team', 'chat'],
    },
  ],
};
```

Note how the autogenerate source directories themselves don't become categories: only the items they contain do. This is what we mean by "sidebar slice".

</details>

## 分类索引约定 {#category-index-convention}

Docusaurus 能自动将分类链接到其索引文档。

分类索引文档是符合以下文件名约定之一的文档：

- 命名为 `index`（不区分大小写）：`docs/Guides/index.md`
- 命名为 `README`（不区分大小写）：`docs/Guides/README.mdx`
- 与父文件夹同名：`docs/Guides/Guides.md`

这等同于使用带有[文档链接](items.mdx#category-doc-link)的分类：

```js title="sidebars.js"
export default {
  docs: [
    // highlight-start
    {
      type: 'category',
      label: 'Guides',
      link: {type: 'doc', id: 'Guides/index'},
      items: [],
    },
    // highlight-end
  ],
};
```

:::tip

将介绍性文档命名为 `README.md` 可在 GitHub 界面浏览文件夹时显示，而使用 `index.md` 则更符合 HTML 文件的访问行为。

:::

:::tip

若文件夹仅包含一个索引页，该条目将显示为链接而非分类。这适用于**资源共置**场景：

```
some-doc
├── index.md
├── img1.png
└── img2.png
```

:::

<details>

<summary>Customizing category index matching</summary>

It is possible to opt out any of the category index conventions, or define even more conventions. You can inject your own `isCategoryIndex` matcher through the [`sidebarItemsGenerator`](#customize-the-sidebar-items-generator) callback. For example, you can also pick `intro` as another file name eligible for automatically becoming the category index.

```js title="docusaurus.config.js"
export default {
  plugins: [
    [
      '@docusaurus/plugin-content-docs',
      {
        async sidebarItemsGenerator({
          ...args,
          isCategoryIndex: defaultCategoryIndexMatcher, // The default matcher implementation, given below
          defaultSidebarItemsGenerator,
        }) {
          return defaultSidebarItemsGenerator({
            ...args,
            // highlight-start
            isCategoryIndex(doc) {
              return (
                // Also pick intro.md in addition to the default ones
                doc.fileName.toLowerCase() === 'intro' ||
                defaultCategoryIndexMatcher(doc)
              );
            },
            // highlight-end
          });
        },
      },
    ],
  ],
};
```

Or choose to not have any category index convention.

```js title="docusaurus.config.js"
export default {
  plugins: [
    [
      '@docusaurus/plugin-content-docs',
      {
        async sidebarItemsGenerator({
          ...args,
          isCategoryIndex: defaultCategoryIndexMatcher, // The default matcher implementation, given below
          defaultSidebarItemsGenerator,
        }) {
          return defaultSidebarItemsGenerator({
            ...args,
            // highlight-start
            isCategoryIndex() {
              // No doc will be automatically picked as category index
              return false;
            },
            // highlight-end
          });
        },
      },
    ],
  ],
};
```

The `isCategoryIndex` matcher will be provided with three fields:

- `fileName`, the file's name without extension and with casing preserved
- `directories`, the list of directory names _from the lowest level to the highest level_, relative to the docs root directory
- `extension`, the file's extension, with a leading dot.

For example, for a doc file at `guides/sidebar/autogenerated.md`, the props the matcher receives are

```js
const props = {
  fileName: 'autogenerated',
  directories: ['sidebar', 'guides'],
  extension: '.md',
};
```

The default implementation is:

```js
function isCategoryIndex({fileName, directories}) {
  const eligibleDocIndexNames = [
    'index',
    'readme',
    directories[0].toLowerCase(),
  ];
  return eligibleDocIndexNames.includes(fileName.toLowerCase());
}
```

</details>

## 自动生成侧边栏元数据 {#autogenerated-sidebar-metadata}

对于手动编写的侧边栏定义，您需要通过 `sidebars.js` 提供元数据；而自动生成时，Docusaurus 会从各条目对应文件中读取元数据。此外，您可能需要调整条目的相对位置，因为默认情况下侧边栏片段中的条目会按**字母顺序**（根据文件和文件夹名称）生成。

### 文档条目元数据 {#doc-item-metadata}

`label`、`className` 和 `customProps` 属性分别通过 front matter 中的 `sidebar_label`、`sidebar_class_name` 和 `sidebar_custom_props` 声明。位置信息同样可通过 front matter 中的 `sidebar_position` 指定。

```md title="docs/tutorials/tutorial-easy.md"
---
# highlight-start
sidebar_position: 2
sidebar_label: Easy
sidebar_class_name: green
# highlight-end
---

# Easy Tutorial

This is the easy tutorial!
```

### 分类条目元数据 {#category-item-metadata}

在对应文件夹中添加 `_category_.json` 或 `_category_.yml` 文件。您可以指定任意分类元数据及 `position` 元数据。若分类存在关联文档，则 `label`、`className`、`position` 和 `customProps` 将默认采用该文档的对应值。

<Tabs>
<TabItem value="JSON">

```json title="docs/tutorials/_category_.json"
{
  "position": 2.5,
  "label": "Tutorial",
  "collapsible": true,
  "collapsed": false,
  "className": "red",
  "link": {
    "type": "generated-index",
    "title": "Tutorial overview"
  },
  "customProps": {
    "description": "This description can be used in the swizzled DocCard"
  }
}
```

</TabItem>
<TabItem value="YAML">

```yml title="docs/tutorials/_category_.yml"
position: 2.5 # float position is supported
label: 'Tutorial'
collapsible: true # make the category collapsible
collapsed: false # keep the category open by default
className: red
link:
  type: generated-index
  title: Tutorial overview
customProps:
  description: This description can be used in the swizzled DocCard
```

</TabItem>
</Tabs>

:::info

若显式指定了 `link`，Docusaurus 将不会应用任何[默认约定](#category-index-convention)。

文档链接可采用相对路径指定，例如：若分类由 `guides` 目录生成，则 `"link": {"type": "doc", "id": "intro"}` 会先解析为 ID `guides/intro`，仅当该 ID 不存在时才回退到 `intro`。

您也可使用 `link: null` 来显式禁用默认约定且不生成分类索引页。

:::

:::info

位置元数据仅作用于**侧边栏片段内部**：Docusaurus 不会重新排序侧边栏的其他条目。

:::

## 使用数字前缀 {#using-number-prefixes}

对自动生成的侧边栏进行排序的简单方法是为文档和文件夹添加数字前缀，这样按文件名排序时它们在文件系统中的显示顺序也会保持一致：

```bash
docs
├── 01-Intro.md
├── 02-Tutorial Easy
│   ├── 01-First Part.md
│   ├── 02-Second Part.md
│   └── 03-End.md
├── 03-Tutorial Advanced
│   ├── 01-First Part.md
│   ├── 02-Second Part.md
│   ├── 03-Third Part.md
│   └── 04-End.md
└── 04-End.md
```

为了**降低使用门槛**，Docusaurus 支持**多种数字前缀模式**。

默认情况下，Docusaurus 会**移除数字前缀**，不会将其显示在文档 ID、标题、标签和 URL 路径中。

:::warning

**建议优先使用[附加元数据](#autogenerated-sidebar-metadata)**。

更新数字前缀可能很麻烦，因为这可能要求**修改多个现有的 Markdown 链接**：

```diff title="docs/02-Tutorial Easy/01-First Part.md"
- 查看[教程结尾](../04-End.mdx);
+ 查看[教程结尾](../05-End.mdx);
```

:::

## 自定义侧边栏项目生成器 {#customize-the-sidebar-items-generator}

您可以在文档插件（或预设）配置中提供自定义的 `sidebarItemsGenerator` 函数：

```js title="docusaurus.config.js"
export default {
  plugins: [
    [
      '@docusaurus/plugin-content-docs',
      {
        // highlight-start
        async sidebarItemsGenerator({
          defaultSidebarItemsGenerator,
          numberPrefixParser,
          item,
          version,
          docs,
          categoriesMetadata,
          isCategoryIndex,
        }) {
          // Example: return an hardcoded list of static sidebar items
          return [
            {type: 'doc', id: 'doc1'},
            {type: 'doc', id: 'doc2'},
          ];
        },
        // highlight-end
      },
    ],
  ],
};
```

:::tip

**复用并增强默认生成器**，而非从头编写生成器：[我们提供的默认生成器](https://github.com/facebook/docusaurus/blob/main/packages/docusaurus-plugin-content-docs/src/sidebars/generator.ts)长达 250 行代码。

根据您的使用场景**添加、更新、筛选、重新排序**侧边栏项目：

```js title="docusaurus.config.js"
// highlight-start
// 反转侧边栏项目顺序（包括嵌套的分类项目）
function reverseSidebarItems(items) {
  // 反转分类中的项目
  const result = items.map((item) => {
    if (item.type === 'category') {
      return {...item, items: reverseSidebarItems(item.items)};
    }
    return item;
  });
  // 反转当前层级的项目
  result.reverse();
  return result;
}
// highlight-end

export default {
  plugins: [
    [
      '@docusaurus/plugin-content-docs',
      {
        // highlight-start
        async sidebarItemsGenerator({defaultSidebarItemsGenerator, ...args}) {
          const sidebarItems = await defaultSidebarItemsGenerator(args);
          return reverseSidebarItems(sidebarItems);
        },
        // highlight-end
      },
    ],
  ],
};
```

:::